{% if complaint.status == constant('App\\Entity\\Complaint::STATUS_APPOINTMENT_PENDING') %}
    {% set status_btn_color = 'info' %}
    {% set status = complaint.status %}
{% elseif complaint.status == constant('App\\Entity\\Complaint::STATUS_ASSIGNMENT_PENDING') %}
    {% set status_btn_color = 'secondary' %}
    {% set status = complaint.status %}
{% elseif complaint.status == constant('App\\Entity\\Complaint::STATUS_ASSIGNED') %}
    {% set status_btn_color = 'primary' %}
    {% set status = complaint.status %}
    {% if not is_granted('ROLE_SUPERVISOR') %}
        {% set status = 'pel.to.process' %}
    {% endif %}
{% elseif complaint.status == constant('App\\Entity\\Complaint::STATUS_CLOSED') %}
    {% set status_btn_color = 'dark' %}
    {% set status = complaint.status %}
{% elseif complaint.status == constant('App\\Entity\\Complaint::STATUS_ONGOING_LRP') %}
    {% set status_btn_color = 'warning' %}
    {% set status = complaint.status %}
{% elseif complaint.status == constant('App\\Entity\\Complaint::STATUS_MP_DECLARANT') %}
    {% set status_btn_color = 'success' %}
    {% set status = complaint.status %}
{% elseif complaint.status == constant('App\\Entity\\Complaint::STATUS_REASSIGNMENT_PENDING') %}
    {% set status_btn_color = 'reassignment-pending' %}
    {% set status = complaint.status %}
{% elseif complaint.status == constant('App\\Entity\\Complaint::STATUS_REJECTED') %}
    {% set status_btn_color = 'danger' %}
    {% set status = complaint.status %}
{% endif %}

{% if is_granted('ROLE_SUPERVISOR') %}
    {% set checkbox = '<input type="checkbox" class="form-check-input">' %}
{% else %}
    {% set checkbox = null %}
{% endif %}

{{ {
    checkbox,
    'createdAt':complaint.createdAt|date('d/m/Y', app.user.timezone),
    '__facts_natures':include('common/_complaint_natures.html.twig', {'natures':complaint.facts.natures}),
    '__facts_startDate':complaint.facts.startDate|date('d/m/Y'),
    'alert':complaint.alert|u.truncate(15, '...'),
    'appointmentDate':complaint.appointmentDate|date('d/m/Y'),
    '__identity_firstname':(complaint.identity.firstName ~ ' ' ~ complaint.identity.lastName)|u.truncate(15, '...'),
    'status': include('common/_link.html.twig', {path: path('complaint_summary', {id: complaint.id}), label: status|trans|u.truncate(15, '...'), class:'btn btn-sm btn-' ~ status_btn_color}),
    '__assignedTo_appellation':complaint.assignedTo|u.truncate(15, '...'),
    'declarationNumber':include('common/_link.html.twig', {path: path('complaint_summary', {id: complaint.id}), label: complaint.declarationNumber}),
    '___count_comments': complaint.comments|length,
}|json_encode|raw }}
