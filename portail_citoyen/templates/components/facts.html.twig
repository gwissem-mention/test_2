<div {{ attributes.add(stimulus_controller('complaint-submit')) }}>
    {{ form_start(form, {attr: {'data-action': 'live#action complaint-submit#submit','data-action-name': 'prevent|submit'}}) }}
    <div class="p-10 lg:py-30 lg:px-10">
        <h1 class="hidden lg:block text-2xl lg:text-3xl font-bold mb-3">{{ 'pel.what.is.the.date.of.the.infraction'|trans }}</h1>
        <h2 class="block lg:hidden text-2xl lg:text-3xl font-bold mb-3">{{ 'pel.what.is.the.date.of.the.infraction'|trans }}</h2>
        <div class="block lg:flex items-center justify-start [width:100%] mb-5">
            <div class="[width:100%] lg:[width:34%]">
                <div class="fr-grid-row fr-py-2w">
                    <div class="fr-col">
                        {{ form_row(form.offenseDate.exactDateKnown) }}
                    </div>
                </div>
            </div>
            {% if form.offenseDate.startDate is defined %}
                <div class="[width:100%] lg:[width:33%]">
                    <div class="fr-grid-row fr-py-2w">
                        <div class="fr-col m-0 lg:ml-5">
                            {{ form_row(form.offenseDate.startDate) }}
                        </div>
                    </div>
                </div>
                {% if form.offenseDate.endDate is defined %}
                    <div class="[width:100%] lg:[width:33%]">
                        <div class="fr-grid-row fr-py-2w">
                            <div class="fr-col m-0 lg:ml-5">
                                {{ form_row(form.offenseDate.endDate) }}
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endif %}
        </div>
        <hr>
        <div class="block lg:flex items-center justify-start [width:100%] mb-5">
            <div class="[width:100%] lg:[width:34%]">
                <div class="fr-grid-row fr-py-2w">
                    <div class="fr-col">
                        {{ form_row(form.offenseDate.choiceHour) }}
                    </div>
                </div>
            </div>
            {% if form.offenseDate.startHour is defined or form.offenseDate.hour is defined %}
                {% if form.offenseDate.hour is defined %}
                    <div class="[width:100%] lg:[width:33%]">
                        <div class="fr-grid-row fr-py-2w">
                            <div class="fr-col m-0 lg:ml-5">
                                {{ form_row(form.offenseDate.hour) }}
                            </div>
                        </div>
                    </div>
                {% elseif form.offenseDate.endHour is defined %}
                    <div class="[width:100%] lg:[width:33%]">
                        <div class="fr-grid-row fr-py-2w">
                            <div class="fr-col m-0 lg:ml-5">
                                {{ form_row(form.offenseDate.startHour) }}
                            </div>
                        </div>
                    </div>
                {% endif %}
                {% if form.offenseDate.endHour is defined %}
                    <div class="[width:100%] lg:[width:33%]">
                        <div class="fr-grid-row fr-py-2w">
                            <div class="fr-col m-0 lg:ml-5">
                                {{ form_row(form.offenseDate.endHour) }}
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endif %}
        </div>
    </div>
    <hr>
    <div class="p-10 lg:py-30 lg:px-10">
        <h2 class="text-2xl lg:text-3xl font-bold mb-3">{{ 'pel.what.is.the.place.of.the.infraction'|trans }}</h2>
        <div class="block lg:flex items-start justify-start [width:100%] mb-5">
            <div class="[width:100%] lg:[width:50%]">
                <div class="fr-grid-row fr-py-2w">
                    <div class="fr-col">
                        {{ form_row(form.placeNature) }}
                        {% if form.vars.data.placeNature in [5,11] or (identityAddress is not null and identityAddress.addressType is not same as('etalab_address')) %}
                            <div class="fr-grid-row fr-py-2w">
                                <div class="fr-col">
                                    {{ component('google_maps', {
                                        'data-live-id':'google-maps',
                                        'id':'facts',
                                    }) }}
                                </div>
                            </div>
                        {% endif %}
                        {% if form.address.startAddress is defined %}
                            <div class="fr-grid-row fr-py-2w">
                                <div class="fr-col">
                                    {% set etalab_errors = [] %}
                                    {% if form.address.startAddress is defined %}
                                        {% for error in form.address.startAddress.address.vars.errors %}
                                            {% set etalab_errors = etalab_errors|merge([error.message]) %}
                                        {% endfor %}
                                    {% endif %}
                                    <div class="fr-input-group{% if etalab_errors|length > 0 %} fr-input-group--error{% endif %}">
                                        {{ form_label(form.address.startAddress) }}
                                        {{ component('etalab_component', {
                                            'data-live-id': 'facts-startAddress-address',
                                            dataModel: 'addressSearch:startAddressEtalabInput.addressSearch addressId:startAddressEtalabInput.addressId addressSearchSaved:startAddressEtalabInput.addressSearchSaved latitude:startAddressEtalabInput.latitude longitude:startAddressEtalabInput.longitude',
                                            inputName: 'facts-startAddress-address',
                                            errors: etalab_errors,
                                        }) }}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if form.address.endAddress is defined %}
                            <div class="fr-grid-row fr-py-2w">
                                <div class="fr-col">
                                    {% set etalab_errors = [] %}
                                    {% if form.address.endAddress is defined %}
                                        {% for error in form.address.endAddress.address.vars.errors %}
                                            {% set etalab_errors = etalab_errors|merge([error.message]) %}
                                        {% endfor %}
                                    {% endif %}
                                    <div class="fr-input-group{% if etalab_errors|length > 0 %} fr-input-group--error{% endif %}">
                                        {{ form_label(form.address.endAddress) }}
                                        {{ component('etalab_component', {
                                            'data-live-id': 'facts-endAddress-address',
                                            dataModel: 'addressSearch:endAddressEtalabInput.addressSearch addressId:endAddressEtalabInput.addressId addressSearchSaved:endAddressEtalabInput.addressSearchSaved',
                                            inputName: 'facts-endAddress-address',
                                            errors: etalab_errors,
                                        }) }}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="fr-grid-row fr-py-2w">
                    <div class="fr-col">
                        {{ form_row(form.address.addressAdditionalInformation) }}
                    </div>
                </div>
            </div>
            <div class="[width:100%] lg:[width:50%]">
                <div class="fr-grid-row fr-py-2w">
                    <div class="fr-col m-0 lg:ml-10">
                        {{ form_row(form.address.addressOrRouteFactsKnown) }}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="p-10 lg:py-30 lg:px-10">
        <h2 class="text-2xl lg:text-3xl font-bold mb-3">{{ 'pel.describe.whats.happened'|trans }}</h2>
        <div class="fr-grid-row fr-py-2w mb-5">
            {% embed 'embed/counter.html.twig' with {
                'parent': 'facts_description',
                'minlength': form.description.vars.attr.minlength,
                'maxlength': form.description.vars.attr.maxlength
            } %}
                {% block label %}
                    {{ form_label(form.description) }}
                    <div class="fr-hint-text">{{ 'pel.resume.the.infraction.in.few.words'|trans }}</div>
                {% endblock %}
                {% block widget %}
                    {{ form_widget(form.description) }}
                {% endblock %}
                {% block errors %}
                    {{ form_errors(form.description) }}
                {% endblock %}
            {% endembed %}
        </div>
        <div class="mb-10">
            <div class="fr-alert fr-alert--info fr-alert--sm">
                <p>{{ 'pel.your.declaration.will.be.reviewed.by.an.agent'|trans }}</p>
            </div>
        </div>
        <hr>
        <div class="fr-grid-row fr-py-2w">
            <div class="fr-col">
                {{ form_row(form.victimOfViolence) }}
            </div>
        </div>
        {% if form.victimOfViolenceText is defined %}
            <div class="fr-grid-row fr-py-2w">
                <div class="fr-col">
                    {{ form_row(form.victimOfViolenceText) }}
                </div>
            </div>
            <div class="fr-grid-row fr-py-2w">
                <div class="fr-col">
                    <span class="fr-text--red-marianne">
                        {{ 'pel.victim.of.violence.information'|trans }}
                    </span>
                </div>
            </div>
        {% endif %}
        {% if form.address.addressNotKnown is defined %}
            <div class="fr-grid-row fr-py-2w">
                <div class="fr-col">
                    {{ form_row(form.address.addressNotKnown) }}
                </div>
            </div>
        {% endif %}
    </div>
    <hr>
    <div class="p-10 pt-5 lg:p-11 lg:pt-7 text-center">
        <div class="flex items-center justify-start lg:justify-between">
            <a href="{{ path('complaint_identity') }}" class="fr-btn fr-btn--secondary fr-btn--icon-left fr-icon-arrow-left-line [width:45px] lg:w-auto mb-4 lg:m-0">
                <span class="hidden lg:block">{{ 'pel.previous'|trans }}</span>
            </a>
            <div class="hidden lg:block">{{ 'pel.all.fields.marked.with'|trans}} <span class="fr-text--red-marianne font-bold">*</span> {{ 'pel.are.mandatory'|trans }}</div>
            <ul class="fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left m-0 p-0 inline-block lg:flex items-center content-between">
                <li>
                    <button type="submit" class="fr-btn fr-btn--icon-right fr-icon-arrow-right-line" id="facts_submit" {% if this.fromSummary is same as(true) %}data-action="live#action" data-action-name="prevent|submit"{% endif %}>{{ this.fromSummary is same as(true) ? 'pel.save.and.go.to.next'|trans : 'pel.next'|trans }}</button>
                </li>
                {% if this.fromSummary is same as(true) %}
                    <li>
                        <button type="submit" class="fr-btn fr-btn--icon-right fr-icon-arrow-right-line" id="facts_submit_recap" data-action="live#action" data-action-name="prevent|submit(redirectToSummary=true)"><span></span>{{ 'pel.save.and.go.to.summary'|trans }}</button>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
    {{ form_end(form, {render_rest: false}) }}
</div>
